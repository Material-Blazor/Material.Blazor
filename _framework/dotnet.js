//! Licensed to the .NET Foundation under one or more agreements.
//! The .NET Foundation licenses this file to you under the MIT license.
const e=Symbol.for("wasm promise_control");function t(t,o){let n=null;const r=new Promise((function(e,r){n={isDone:!1,promise:null,resolve:o=>{n.isDone||(n.isDone=!0,e(o),t&&t())},reject:e=>{n.isDone||(n.isDone=!0,r(e),o&&o())}}}));n.promise=r;const i=r;return i[e]=n,{promise:i,promise_control:n}}function o(t){return t[e]}function n(t){(function(t){return void 0!==t[e]})(t)||B(!1,"Promise is not controllable")}const r="MONO_WASM: ";function i(e,...t){P.diagnosticTracing&&console.debug(r+e,...t)}function s(e,...t){console.info(e,...t)}function a(e,...t){console.warn(r+e,...t)}function l(e,...t){t&&t.length>0&&t[0]&&"object"==typeof t[0]&&t[0].silent||console.error(r+e,...t)}let c,u;function d(e,t,o){const n={log:t.log,error:t.error},r=t;function i(t,o,r){return function(...i){try{let n=i[0];if(void 0===n)n="undefined";else if(null===n)n="null";else if("function"==typeof n)n=n.toString();else if("string"!=typeof n)try{n=JSON.stringify(n)}catch(e){n=n.toString()}if("string"==typeof n)if("["==n[0]){const t=(new Date).toISOString();n="main"!==e?`[${e}][${t}] ${n}`:`[${t}] ${n}`}else"main"!==e&&(n=`[${e}] ${n}`);o(r?JSON.stringify({method:t,payload:n,arguments:i}):[t+n,...i.slice(1)])}catch(e){n.error(`proxyConsole failed: ${e}`)}}}const s=["debug","trace","warn","info","error"];for(const e of s)"function"!=typeof r[e]&&(r[e]=i(`console.${e}: `,t.log,!1));const a=`${o}/console`.replace("https://","wss://").replace("http://","ws://");c=new WebSocket(a),c.addEventListener("open",(()=>{n.log(`browser: [${e}] Console websocket connected.`)})),c.addEventListener("error",(t=>{n.error(`[${e}] websocket error: ${t}`,t)})),c.addEventListener("close",(t=>{n.error(`[${e}] websocket closed: ${t}`,t)}));const l=e=>{c.readyState===WebSocket.OPEN?c.send(e):n.log(e)};for(const e of["log",...s])r[e]=i(`console.${e}`,l,!0)}let f=0;const h={"js-module-threads":!0,"js-module-runtime":!0,"js-module-native":!0,"js-module-dotnet":!0},m={...h,dotnetwasm:!0},g={dotnetwasm:!0,symbols:!0},p={resource:!0,assembly:!0,pdb:!0,heap:!0,icu:!0,...h,dotnetwasm:!0},b={...h,dotnetwasm:!0,symbols:!0};function w(e){return!("icu"==e.behavior&&e.name!=P.preferredIcuAsset)}function y(e){var t;const o=null===(t=P.config.assets)||void 0===t?void 0:t.find((t=>t.behavior==e));return o||B(!1,`Can't find asset for ${e}`),o.resolvedUrl||(o.resolvedUrl=E(o,"")),o}async function v(){i("mono_download_assets"),P.maxParallelDownloads=P.config.maxParallelDownloads||P.maxParallelDownloads,P.enableDownloadRetry=P.config.enableDownloadRetry||P.enableDownloadRetry;try{const e=[],t=[],o=[];for(const o of P.config.assets){const n=o;"object"!=typeof n&&B(!1,"asset must be object"),"string"!=typeof n.behavior&&B(!1,"asset behavior must be known string"),"string"!=typeof n.name&&B(!1,"asset name must be string"),n.resolvedUrl&&"string"!=typeof n.resolvedUrl&&B(!1,"asset resolvedUrl could be string"),n.hash&&"string"!=typeof n.hash&&B(!1,"asset resolvedUrl could be string"),n.pendingDownload&&"object"!=typeof n.pendingDownload&&B(!1,"asset pendingDownload could be object"),p[n.behavior]?t.push(n):e.push(n)}const n=e=>{!b[e.behavior]&&w(e)&&P.expected_instantiated_assets_count++,!m[e.behavior]&&w(e)&&(P.expected_downloaded_assets_count++,o.push(_(e)))};for(const t of e)n(t);await P.runtimeModuleLoaded.promise,await $.memorySnapshotSkippedOrDone.promise;for(const e of t)if($.loadedMemorySnapshot){if(D(e),"resource"==e.behavior||"assembly"==e.behavior||"pdb"==e.behavior){const t=E(e,""),o="string"==typeof e.virtualPath?e.virtualPath:e.name;P._loaded_files.push({url:t,file:o})}}else n(e);P.allDownloadsQueued.promise_control.resolve(),await P.runtimeModuleLoaded.promise;const r=[];for(const e of o)r.push((async()=>{const t=await e;if(t.buffer){if(!b[t.behavior]){const e=t.pendingDownloadInternal.url;t.buffer&&"object"==typeof t.buffer||B(!1,"asset buffer must be array or buffer like");const o=new Uint8Array(t.buffer);D(t),await $.beforeOnRuntimeInitialized.promise,await $.memorySnapshotSkippedOrDone.promise,$.instantiate_asset(t,e,o)}}else g[t.behavior]?("symbols"===t.behavior&&(await $.instantiate_symbols_asset(t),D(t)),g[t.behavior]&&++P.actual_downloaded_assets_count):(t.isOptional||B(!1,"Expected asset to have the downloaded buffer"),!m[t.behavior]&&w(t)&&P.expected_downloaded_assets_count--,!b[t.behavior]&&w(t)&&P.expected_instantiated_assets_count--)})());Promise.all(r).then((()=>{$.allAssetsInMemory.promise_control.resolve()})).catch((e=>{throw P.err("Error in mono_download_assets: "+e),H(1,e),e}))}catch(e){throw P.err("Error in mono_download_assets: "+e),e}}async function _(e){try{return await C(e)}catch(t){if(!P.enableDownloadRetry)throw t;if(k||j)throw t;if(e.pendingDownload&&e.pendingDownloadInternal==e.pendingDownload)throw t;if(e.resolvedUrl&&-1!=e.resolvedUrl.indexOf("file://"))throw t;if(t&&404==t.status)throw t;e.pendingDownloadInternal=void 0,await P.allDownloadsQueued.promise;try{return await C(e)}catch(t){return e.pendingDownloadInternal=void 0,await(100,new Promise((e=>globalThis.setTimeout(e,100)))),await C(e)}}}async function C(e){for(;u;)await u.promise;try{++f,f==P.maxParallelDownloads&&(i("Throttling further parallel downloads"),u=t());const o=await async function(e){if(e.pendingDownload&&(e.pendingDownloadInternal=e.pendingDownload),e.pendingDownloadInternal&&e.pendingDownloadInternal.response)return e.pendingDownloadInternal.response;if(e.buffer){const t=e.buffer;return e.buffer=null,e.pendingDownloadInternal={url:"undefined://"+e.name,name:e.name,response:Promise.resolve({arrayBuffer:()=>t,headers:{get:()=>{}}})},e.pendingDownloadInternal.response}const t=e.loadRemote&&P.config.remoteSources?P.config.remoteSources:[""];let o;for(let n of t){n=n.trim(),"./"===n&&(n="");const t=E(e,n);e.name===t?i(`Attempting to download '${t}'`):i(`Attempting to download '${t}' for ${e.name}`);try{e.resolvedUrl=t;const n=A(e);if(e.pendingDownloadInternal=n,o=await n.response,!o||!o.ok)continue;return o}catch(e){o||(o={ok:!1,url:t,status:0,statusText:""+e});continue}}const n=e.isOptional||e.name.match(/\.pdb$/)&&P.config.ignorePdbLoadErrors;if(o||B(!1,`Response undefined ${e.name}`),!n){const t=new Error(`download '${o.url}' for ${e.name} failed ${o.status} ${o.statusText}`);throw t.status=o.status,t}P.out(`optional download '${o.url}' for ${e.name} failed ${o.status} ${o.statusText}`)}(e);return o?(g[e.behavior]||(e.buffer=await o.arrayBuffer(),++P.actual_downloaded_assets_count),e):e}finally{if(--f,u&&f==P.maxParallelDownloads-1){i("Resuming more parallel downloads");const e=u;u=void 0,e.promise_control.resolve()}}}function E(e,t){let o;null==t&&B(!1,`sourcePrefix must be provided for ${e.name}`);const n=P.config.assemblyRootFolder;if(e.resolvedUrl)o=e.resolvedUrl;else{if(""===t)if("assembly"===e.behavior||"pdb"===e.behavior)o=n?n+"/"+e.name:e.name;else if("resource"===e.behavior){const t=e.culture&&""!==e.culture?`${e.culture}/${e.name}`:e.name;o=n?n+"/"+t:t}else o=e.name;else o=t+e.name;o=R(P.locateFile(o),e.behavior)}return o&&"string"==typeof o||B(!1,"attemptUrl need to be path or url string"),o}function R(e,t){return P.modulesUniqueQuery&&h[t]&&(e+=P.modulesUniqueQuery),e}function A(e){try{if("function"==typeof P.downloadResource){const t=P.downloadResource(e);if(t)return t}const t={};e.hash&&(t.integrity=e.hash);const o=P.fetch_like(e.resolvedUrl,t);return{name:e.name,url:e.resolvedUrl,response:o}}catch(t){const o={ok:!1,url:e.resolvedUrl,status:500,statusText:"ERR29: "+t,arrayBuffer:()=>{throw t},json:()=>{throw t}};return{name:e.name,url:e.resolvedUrl,response:Promise.resolve(o)}}}function D(e){e.pendingDownloadInternal=null,e.pendingDownload=null,e.buffer=null}let O;function T(e){return O=O||document.createElement("a"),O.href=e,O.href}function S(e){return!!globalThis.navigator&&((!!e.resources.pdb||e.debugBuild||0!=e.debugLevel)&&(P.isChromium||P.isFirefox))}async function x(e,t,o){if(o&&await async function(e,t){var o,n,r,i;P.libraryInitializers||(P.libraryInitializers=[]);const s="onRuntimeConfigLoaded"==t?null===(n=null===(o=e.resources)||void 0===o?void 0:o.libraryStartupModules)||void 0===n?void 0:n.onRuntimeConfigLoaded:null===(i=null===(r=e.resources)||void 0===r?void 0:r.libraryStartupModules)||void 0===i?void 0:i.onRuntimeReady;if(!s)return;const l=Object.keys(s);await Promise.all(l.map((e=>async function(e){try{const t=R(P.locateFile(e),"js-module-library-initializer"),o=await import(t);P.libraryInitializers.push({scriptName:e,exports:o})}catch(t){a(`Failed to import library initializer '${e}': ${t}`)}}(e))))}(P.config,o),!P.libraryInitializers)return;const n=[];for(let o=0;o<P.libraryInitializers.length;o++){const r=P.libraryInitializers[o];r.exports[e]&&n.push(L(r.scriptName,e,(()=>r.exports[e](...t))))}await Promise.all(n)}async function L(e,t,o){try{await o()}catch(o){throw a(`Failed to invoke '${t}' on library initializer '${e}': ${o}`),H(1,o),o}}const j="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,I="object"==typeof window,M="function"==typeof importScripts,k=!I&&!j&&!M;let U,$=null,P=null,F=null,W=!1;const z={mono:{},binding:{},internal:{},module:{},loaderHelpers:{},runtimeHelpers:{},api:{}};function B(e,t){if(e)return;const o="Assert failed: "+("function"==typeof t?t():t),n=z.runtimeHelpers.mono_wasm_abort;throw n&&(l(o),n()),new Error(o)}function N(){return void 0!==P.exitCode}function V(){return $.runtimeReady&&!N()}function q(){$.runtimeReady||B(!1,"mono runtime didn't start yet"),P.assertAfterExit&&N()&&B(!1,`mono runtime already exited with ${P.exitCode}`)}function H(e,t){const o=t&&"object"==typeof t;e=o&&"number"==typeof t.status?t.status:e;const n=o&&"string"==typeof t.message?t.message:""+t;if((t=o?t:$.ExitStatus?new $.ExitStatus(e):new Error("Exit with code "+e+" "+n)).status=e,t.message||(t.message=n),t.stack||(t.stack=(new Error).stack||""),t.silent=!0,!N()){try{t.stack,$.runtimeReady||(i("abort_startup, reason: "+t),function(e){P.allDownloadsQueued.promise_control.reject(e),P.afterConfigLoaded.promise_control.reject(e),P.wasmDownloadPromise.promise_control.reject(e),P.runtimeModuleLoaded.promise_control.reject(e),$.dotnetReady&&($.dotnetReady.promise_control.reject(e),$.memorySnapshotSkippedOrDone.promise_control.reject(e),$.afterInstantiateWasm.promise_control.reject(e),$.beforePreInit.promise_control.reject(e),$.afterPreInit.promise_control.reject(e),$.afterPreRun.promise_control.reject(e),$.beforeOnRuntimeInitialized.promise_control.reject(e),$.afterOnRuntimeInitialized.promise_control.reject(e),$.afterPostRun.promise_control.reject(e))}(t)),function(e,t){if(0!==e&&t&&(t instanceof Error?$.stringify_as_error_with_stack?l($.stringify_as_error_with_stack(t)):l(t.message+"\n"+t.stack):l("string"==typeof t?t:JSON.stringify(t))),P.config&&P.config.logExitCode)if(c){const t=()=>{0==c.bufferedAmount?s("WASM EXIT "+e):globalThis.setTimeout(t,100)};t()}else s("WASM EXIT "+e)}(e,t),function(e){if(I&&P.config&&P.config.appendElementOnExit){const t=document.createElement("label");t.id="tests_done",e&&(t.style.background="red"),t.innerHTML=e.toString(),document.body.appendChild(t)}}(e),$.jiterpreter_dump_stats&&$.jiterpreter_dump_stats(!1)}catch(e){}P.exitCode=e}if(P.config&&P.config.asyncFlushOnExit&&0===e)throw(async()=>{try{await async function(){try{const e=await import("process"),t=e=>new Promise(((t,o)=>{e.on("error",(e=>o(e))),e.write("",(function(){t()}))})),o=t(e.stderr),n=t(e.stdout);await Promise.all([n,o])}catch(e){l(`flushing std* streams failed: ${e}`)}}()}finally{J(e,t)}})(),t;J(e,t)}function J(e,t){if(V()&&$.mono_wasm_exit&&$.mono_wasm_exit(e),0!==e||!I)throw j&&U.process?U.process.exit(e):$.quit&&$.quit(e,t),t}let G,Q;!function(e){if(W)throw new Error("Loader module already loaded");W=!0,$=e.runtimeHelpers,P=e.loaderHelpers,F=e.api,U=e.internal,Object.assign(F,{INTERNAL:U,invokeLibraryInitializers:x}),Object.assign(e.module,{disableDotnet6Compatibility:!0,config:{environmentVariables:{}}}),Object.assign($,{mono_wasm_bindings_is_ready:!1,javaScriptExports:{},config:e.module.config,diagnosticTracing:!1}),Object.assign(P,{config:e.module.config,diagnosticTracing:!1,maxParallelDownloads:16,enableDownloadRetry:!0,assertAfterExit:!I,_loaded_files:[],loadedFiles:[],loadedAssemblies:[],actual_downloaded_assets_count:0,actual_instantiated_assets_count:0,expected_downloaded_assets_count:0,expected_instantiated_assets_count:0,afterConfigLoaded:t(),allDownloadsQueued:t(),wasmDownloadPromise:t(),runtimeModuleLoaded:t(),is_exited:N,is_runtime_running:V,assert_runtime_running:q,mono_exit:H,createPromiseController:t,getPromiseController:o,assertIsControllablePromise:n,mono_download_assets:v,resolve_asset_path:y,setup_proxy_console:d,hasDebuggingEnabled:S,invokeLibraryInitializers:x})}(z);const Z=class{constructor(e){this.url=e}toString(){return this.url}};const K="function"==typeof globalThis.fetch;async function Y(e,t){try{if(j){const o=e.startsWith("file://");if(!o&&K)return globalThis.fetch(e,t||{credentials:"same-origin"});G||(Q=U.require("url"),G=U.require("fs")),o&&(e=Q.fileURLToPath(e));const n=await G.promises.readFile(e);return{ok:!0,headers:{length:0,get:()=>null},url:e,arrayBuffer:()=>n,json:()=>JSON.parse(n),text:()=>{throw new Error("NotImplementedException")}}}if(K)return globalThis.fetch(e,t||{credentials:"same-origin"});if("function"==typeof read)return{ok:!0,url:e,headers:{length:0,get:()=>null},arrayBuffer:()=>new Uint8Array(read(e,"binary")),json:()=>JSON.parse(read(e,"utf8")),text:()=>read(e,"utf8")}}catch(t){return{ok:!1,url:e,status:500,headers:{length:0,get:()=>null},statusText:"ERR28: "+t,arrayBuffer:()=>{throw t},json:()=>{throw t},text:()=>{throw t}}}throw new Error("No fetch implementation available")}const X=/^[a-zA-Z][a-zA-Z\d+\-.]*?:\/\//,ee=/[a-zA-Z]:[\\/]/;var te="Release";class oe{constructor(e,t){this.bootConfig=e,this.applicationEnvironment=t}static fromFetchResponse(e,t,o){const n=o||P.getApplicationEnvironment&&P.getApplicationEnvironment(e)||e.headers.get("Blazor-Environment")||e.headers.get("DotNet-Environment")||"Production";return t.modifiableAssemblies=e.headers.get("DOTNET-MODIFIABLE-ASSEMBLIES"),t.aspnetCoreBrowserTools=e.headers.get("ASPNETCORE-BROWSER-TOOLS"),new oe(t,n)}static async initAsync(e,t){const o="_framework/blazor.boot.json",n=void 0!==e?e("manifest","blazor.boot.json",o,""):s(o);let r;r=n?"string"==typeof n?await s(n):await n:await s(o);const i=await r.json();return oe.fromFetchResponse(r,i,t);function s(e){return fetch(e,{method:"GET",credentials:"include",cache:"no-cache"})}}}const ne=["configuration"];class re{static async initAsync(e,t){const o=await async function(e){if(!e.cacheBootResources||"undefined"==typeof caches)return null;if(!1===window.isSecureContext)return null;const t=`dotnet-resources-${document.baseURI.substring(document.location.origin.length)}`;try{return await caches.open(t)||null}catch(e){return null}}(e);return new re(e,o,t)}constructor(e,t,o){this.bootConfig=e,this.cacheIfUsed=t,this.loadBootResource=o,this.usedCacheKeys={},this.networkLoads={},this.cacheLoads={}}loadResources(e,t,o){return Object.keys(e).map((n=>this.loadResource(n,t(n),e[n],o)))}loadResource(e,t,o,n){const r=this.cacheIfUsed&&!ne.includes(n)?this.loadResourceWithCaching(this.cacheIfUsed,e,t,o,n):this.loadResourceWithoutCaching(e,t,o,n),i=T(t);return"assembly"==n&&P.loadedAssemblies.push(i),{name:e,url:i,response:r}}logToConsole(){const e=Object.values(this.cacheLoads),t=Object.values(this.networkLoads),o=ie(e),n=ie(t),r=o+n;if(0===r)return;const i=this.bootConfig.linkerEnabled?"%c":"\n%cThis application was built with linking (tree shaking) disabled. Published applications will be significantly smaller.";console.groupCollapsed(`%cdotnet%c Loaded ${se(r)} resources${i}`,"background: purple; color: white; padding: 1px 3px; border-radius: 3px;","font-weight: bold;","font-weight: normal;"),e.length&&(console.groupCollapsed(`Loaded ${se(o)} resources from cache`),console.table(this.cacheLoads),console.groupEnd()),t.length&&(console.groupCollapsed(`Loaded ${se(n)} resources from network`),console.table(this.networkLoads),console.groupEnd()),console.groupEnd()}async purgeUnusedCacheEntriesAsync(){const e=this.cacheIfUsed;if(e){const t=(await e.keys()).map((async t=>{t.url in this.usedCacheKeys||await e.delete(t)}));await Promise.all(t)}}async loadResourceWithCaching(e,t,o,n,r){if(!n||0===n.length)throw new Error("Content hash is required");const i=T(`${o}.${n}`);let s;this.usedCacheKeys[i]=!0;try{s=await e.match(i)}catch(e){}if(s){const e=parseInt(s.headers.get("content-length")||"0");return this.cacheLoads[t]={responseBytes:e},s}{const s=await this.loadResourceWithoutCaching(t,o,n,r);return this.addToCacheAsync(e,t,i,s),s}}loadResourceWithoutCaching(e,t,o,n){if(this.loadBootResource){const r=this.loadBootResource(n,e,t,o);if(r instanceof Promise)return r;"string"==typeof r&&(t=r)}const r={cache:"no-cache"};return"configuration"===n?r.credentials="include":r.integrity=this.bootConfig.cacheBootResources?o:void 0,fetch(t,r)}async addToCacheAsync(e,t,o,n){const r=await n.clone().arrayBuffer(),i=function(e){if("undefined"!=typeof performance)return performance.getEntriesByName(e)[0]}(n.url),s=i&&i.encodedBodySize||void 0;this.networkLoads[t]={responseBytes:s};const a=new Response(r,{headers:{"content-type":n.headers.get("content-type")||"","content-length":(s||n.headers.get("content-length")||"").toString()}});try{await e.put(o,a)}catch(e){}}}function ie(e){return e.reduce(((e,t)=>e+(t.responseBytes||0)),0)}function se(e){return`${(e/1048576).toFixed(2)} MB`}var ae;let le;async function ce(e,t,o){U.resourceLoader=le=await re.initAsync(e.bootConfig,o),function(e,t){const o=le.bootConfig.resources,n=[],r={...le.bootConfig.environmentVariables||{},...e.environmentVariables||{}};e.applicationEnvironment=t,e.remoteSources=le.bootConfig.resources.remoteSources,e.assetsHash=le.bootConfig.resources.hash,e.assets=n,e.extensions=le.bootConfig.extensions,e.resources={extensions:o.extensions},e.debugLevel=S(le.bootConfig)?le.bootConfig.debugLevel:0,e.mainAssemblyName=le.bootConfig.entryAssembly;const i=le.bootConfig;for(const e in le.bootConfig)Object.prototype.hasOwnProperty.call(i,e)&&null===i[e]&&delete i[e];Object.assign(e,{...le.bootConfig}),e.environmentVariables=r,void 0!==le.bootConfig.startupMemoryCache&&(e.startupMemoryCache=le.bootConfig.startupMemoryCache),le.bootConfig.runtimeOptions&&(e.runtimeOptions=[...e.runtimeOptions||[],...le.bootConfig.runtimeOptions]);for(const e in o.runtimeAssets){const t=o.runtimeAssets[e];t.name=e,t.resolvedUrl=R(P.locateFile(e),t.behavior),n.push(t)}for(const e in o.assembly){const t={name:e,resolvedUrl:R(P.locateFile(e),"assembly"),hash:o.assembly[e],behavior:"assembly"};n.push(t)}if(S(le.bootConfig)&&o.pdb)for(const e in o.pdb){const t={name:e,resolvedUrl:R(P.locateFile(e),"pdb"),hash:o.pdb[e],behavior:"pdb"};n.push(t)}const s=e.applicationCulture||(I?navigator.languages&&navigator.languages[0]:Intl.DateTimeFormat().resolvedOptions().locale),a=function(e,t,o){if(e.icuDataMode===ae.Custom){const o=Object.keys(e.resources.runtime).filter((e=>e.startsWith("icudt")&&e.endsWith(".dat")));if(1===o.length)return t.globalizationMode="custom",o[0]}if(e.icuDataMode===ae.Hybrid)return t.globalizationMode="hybrid","icudt_hybrid.dat";if(!o||e.icuDataMode===ae.All)return t.globalizationMode="all","icudt.dat";t.globalizationMode="sharded";const n=o.split("-")[0];return"en"===n||["fr","fr-FR","it","it-IT","de","de-DE","es","es-ES"].includes(o)?"icudt_EFIGS.dat":["zh","ko","ja"].includes(n)?"icudt_CJK.dat":"icudt_no_CJK.dat"}(le.bootConfig,e,s);let l=!1;for(const e in o.runtime){const t=fe(e);let r=!1;if("icu"===t){if(le.bootConfig.icuDataMode===ae.Invariant)continue;if(e!==a)continue;r=!0,l=!0}else{if("js-module-dotnet"===t)continue;if("dotnetwasm"===t)continue}const i={name:e,resolvedUrl:R(P.locateFile(e),t),hash:o.runtime[e],behavior:t,loadRemote:r};n.push(i)}if(e.loadAllSatelliteResources&&o.satelliteResources)for(const e in o.satelliteResources)for(const t in o.satelliteResources[e])n.push({name:t,culture:e,behavior:"resource",hash:o.satelliteResources[e][t]});for(let e=0;e<le.bootConfig.config.length;e++){const o=le.bootConfig.config[e],r=me(o);"appsettings.json"!==r&&r!==`appsettings.${t}.json`||n.push({name:r,resolvedUrl:R(P.locateFile(o),"vfs"),behavior:"vfs"})}for(const e in o.vfs)for(const t in o.vfs[e]){const r={name:t,resolvedUrl:R(P.locateFile(t),"vfs"),hash:o.vfs[e][t],behavior:"vfs",virtualPath:e};n.push(r)}l||(e.globalizationMode="invariant"),le.bootConfig.modifiableAssemblies&&(r.DOTNET_MODIFIABLE_ASSEMBLIES=le.bootConfig.modifiableAssemblies),le.bootConfig.aspnetCoreBrowserTools&&(r.__ASPNETCORE_BROWSER_TOOLS=le.bootConfig.aspnetCoreBrowserTools),e.applicationCulture&&(r.LANG=`${e.applicationCulture}.UTF-8`),void 0!==le.bootConfig.startupMemoryCache&&(e.startupMemoryCache=le.bootConfig.startupMemoryCache),le.bootConfig.runtimeOptions&&(e.runtimeOptions=[...e.runtimeOptions||[],...le.bootConfig.runtimeOptions||[]])}(P.config,e.applicationEnvironment),I&&function(e){P.downloadResource=t=>{const o=he[t.behavior];if(void 0!==o){const n=le.loadResource(t.name,t.resolvedUrl,t.hash,o);return t.pendingDownload=n,de++,n.response.then((()=>{ue++,e.onDownloadResourceProgress&&e.onDownloadResourceProgress(ue,de)})),n}}}(t)}!function(e){e[e.Sharded=0]="Sharded",e[e.All=1]="All",e[e.Invariant=2]="Invariant",e[e.Custom=3]="Custom",e[e.Hybrid=4]="Hybrid"}(ae||(ae={}));let ue=0,de=0;const fe=e=>"dotnet.native.wasm"===e?"dotnetwasm":e.startsWith("dotnet.native.worker")&&e.endsWith(".js")?"js-module-threads":e.startsWith("dotnet.native")&&e.endsWith(".js")?"js-module-native":e.startsWith("dotnet.runtime")&&e.endsWith(".js")?"js-module-runtime":e.startsWith("dotnet")&&e.endsWith(".js")?"js-module-dotnet":e.startsWith("dotnet.native")&&e.endsWith(".symbols")?"symbols":e.startsWith("icudt")?"icu":"other",he={assembly:"assembly",pdb:"pdb",icu:"globalization",vfs:"configuration",dotnetwasm:"dotnetwasm"};function me(e){let t=e.lastIndexOf("/");return t>=0&&t++,e.substring(t)}function ge(e,t){const o={...t};return o.assets&&(o.assets=[...e.assets||[],...o.assets||[]]),o.environmentVariables&&(o.environmentVariables={...e.environmentVariables||{},...o.environmentVariables||{}}),o.runtimeOptions&&(o.runtimeOptions=[...e.runtimeOptions||[],...o.runtimeOptions||[]]),Object.assign(e,o)}function pe(e,t){const o={...t};return o.config&&(e.config||(e.config={}),o.config=ge(e.config,o.config)),Object.assign(e,o)}function be(){const e=P.config;e.environmentVariables=e.environmentVariables||{},e.assets=e.assets||[],e.runtimeOptions=e.runtimeOptions||[],P.assertAfterExit=e.assertAfterExit=e.assertAfterExit||!I,void 0===e.debugLevel&&"Debug"===te&&(e.debugLevel=-1),void 0===e.diagnosticTracing&&"Debug"===te&&(e.diagnosticTracing=!0),$.diagnosticTracing=P.diagnosticTracing=!!e.diagnosticTracing,$.waitForDebugger=e.waitForDebugger,e.startupMemoryCache=!!e.startupMemoryCache,e.startupMemoryCache&&$.waitForDebugger&&(i("Disabling startupMemoryCache because waitForDebugger is set"),e.startupMemoryCache=!1),$.enablePerfMeasure=!!e.browserProfilerOptions&&globalThis.performance&&"function"==typeof globalThis.performance.measure}let we=!1;const ye="__mono_message_please_dont_collide__";let ve=!1;const _e=z.module,Ce=_e.config;async function Ee(e){if("function"==typeof e){const t=e(z.api);if(t.ready)throw new Error("Module.ready couldn't be redefined.");Object.assign(_e,t),pe(_e,t)}else{if("object"!=typeof e)throw new Error("Can't use moduleFactory callback of createDotnetRuntime function.");pe(_e,e)}return await async function(e){const t=import.meta.url,o=t.indexOf("?");var n;if(o>0&&(P.modulesUniqueQuery=t.substring(o)),P.scriptUrl=t.replace(/\\/g,"/").replace(/[?#].*/,""),P.scriptDirectory=(n=P.scriptUrl).slice(0,n.lastIndexOf("/"))+"/",P.locateFile=e=>"URL"in globalThis&&globalThis.URL!==Z?new URL(e,P.scriptDirectory).toString():function(e){return j||k?e.startsWith("/")||e.startsWith("\\")||-1!==e.indexOf("///")||ee.test(e):X.test(e)}(e)?e:P.scriptDirectory+e,P.downloadResource=e.downloadResource,P.fetch_like=Y,P.out=console.log,P.err=console.error,P.getApplicationEnvironment=e.getApplicationEnvironment,I&&globalThis.navigator){const e=globalThis.navigator,t=e.userAgentData&&e.userAgentData.brands;t&&t.length>0?P.isChromium=t.some((e=>"Google Chrome"===e.brand||"Microsoft Edge"===e.brand||"Chromium"===e.brand)):e.userAgent&&(P.isChromium=e.userAgent.includes("Chrome"),P.isFirefox=e.userAgent.includes("Firefox"))}U.require=j?await import("module").then((e=>e.createRequire(import.meta.url))):Promise.resolve((()=>{throw new Error("require not supported")})),void 0===globalThis.URL&&(globalThis.URL=Z)}(_e),_e.ENVIRONMENT_IS_PTHREAD?async function(){(function(){const e=new MessageChannel,t=e.port1,o=e.port2;t.addEventListener("message",(e=>{var n;n=JSON.parse(e.data.config),ve?i("mono config already received"):(ge(P.config,n),be(),i("mono config received"),ve=!0,P.afterConfigLoaded.promise_control.resolve(P.config),I&&n.forwardConsoleLogsToWS&&void 0!==globalThis.WebSocket&&P.setup_proxy_console("pthread-worker",console,self.location.href)),t.close(),o.close()}),{once:!0}),t.start(),self.postMessage({[ye]:{monoCmd:"preload",port:o}},[o])})(),await P.afterConfigLoaded.promise;const e=Re();return Ae(await Promise.all(e)),_e}():async function(){_e.configSrc||_e.config&&0!==Object.keys(_e.config).length&&_e.config.assets||(_e.configSrc="./blazor.boot.json"),await async function(e){const t=e.configSrc;if(we)await P.afterConfigLoaded.promise;else{if(we=!0,!t)return be(),void P.afterConfigLoaded.promise_control.resolve(P.config);i("mono_wasm_load_config");try{if(P.loadBootResource)await async function(e,t){const o=oe.initAsync(P.loadBootResource,e.applicationEnvironment),n=await o;await ce(n,t,P.loadBootResource)}(P.config,e);else{const o=P.locateFile(t),n=await P.fetch_like(o),r=await n.json()||{};if(r.resources)be(),await ce(oe.fromFetchResponse(n,r,P.config.applicationEnvironment),e,P.loadBootResource);else{const e=r;if(e.environmentVariables&&"object"!=typeof e.environmentVariables)throw new Error("Expected config.environmentVariables to be unset or a dictionary-style object");ge(P.config,e)}}if(be(),await x("onRuntimeConfigLoaded",[P.config],"onRuntimeConfigLoaded"),e.onConfigLoaded)try{await e.onConfigLoaded(P.config,F),be()}catch(e){throw l("onConfigLoaded() failed",e),e}P.afterConfigLoaded.promise_control.resolve(P.config)}catch(o){const n=`Failed to load config file ${t} ${o} ${null==o?void 0:o.stack}`;throw P.config=e.config=Object.assign(P.config,{message:n,error:o,isError:!0}),H(1,new Error(n)),o}}}(_e);const e=Re();return _(y("dotnetwasm")).then((e=>{P.wasmDownloadPromise.promise_control.resolve(e)})),function(){if(P.invariantMode="invariant"==P.config.globalizationMode,P.preferredIcuAsset=function(){if(!P.config.assets||P.invariantMode)return null;const e=P.config.assets.filter((e=>"icu"==e.behavior));if(1===e.length)return e[0].name;const t=I?navigator.language:Intl.DateTimeFormat().resolvedOptions().locale,o=t.split("-")[0];return"en"==o||["fr","fr-FR","it","it-IT","de","de-DE","es","es-ES"].includes(t)?"icudt_EFIGS.dat":["zh","ko","ja"].includes(o)?"icudt_CJK.dat":"icudt_no_CJK.dat"}(),!P.invariantMode)if(P.preferredIcuAsset)i("ICU data archive(s) available, disabling invariant mode");else{if("custom"===P.config.globalizationMode||"all"===P.config.globalizationMode||"sharded"===P.config.globalizationMode){const e="invariant globalization mode is inactive and no ICU data archives are available";throw P.err(`ERROR: ${e}`),new Error(e)}i("ICU data archive(s) not available, using invariant globalization mode"),P.invariantMode=!0,P.preferredIcuAsset=null}const e="DOTNET_SYSTEM_GLOBALIZATION_INVARIANT",t="DOTNET_SYSTEM_GLOBALIZATION_HYBRID",o=P.config.environmentVariables;if(void 0===o[t]&&"hybrid"===P.config.globalizationMode?o[t]="1":void 0===o[e]&&P.invariantMode&&(o[e]="1"),void 0===o.TZ)try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone||null;e&&(o.TZ=e)}catch(e){!function(e,...t){console.info(r+e,...t)}("failed to detect timezone, will fallback to UTC")}}(),Ae(await Promise.all(e)),await $.dotnetReady.promise,await x("onRuntimeReady",[z.api],"onRuntimeReady"),F}()}function Re(){return $.runtimeModuleUrl=y("js-module-runtime").resolvedUrl,$.nativeModuleUrl=y("js-module-native").resolvedUrl,[import($.runtimeModuleUrl),import($.nativeModuleUrl)]}function Ae(e){const{initializeExports:t,initializeReplacements:o,configureEmscriptenStartup:n,configureWorkerStartup:r,setRuntimeGlobals:i,passEmscriptenInternals:s}=e[0],{default:a}=e[1];i(z),t(z),P.runtimeModuleLoaded.promise_control.resolve(),a((e=>(Object.assign(_e,{ready:e.ready,__dotnet_runtime:{initializeReplacements:o,configureEmscriptenStartup:n,configureWorkerStartup:r,passEmscriptenInternals:s}}),_e)))}const De=new class{withModuleConfig(e){try{return pe(_e,e),this}catch(e){throw H(1,e),e}}withOnConfigLoaded(e){try{return pe(_e,{onConfigLoaded:e}),this}catch(e){throw H(1,e),e}}withConsoleForwarding(){try{return ge(Ce,{forwardConsoleLogsToWS:!0}),this}catch(e){throw H(1,e),e}}withExitOnUnhandledError(){const e=function(e,t){e.preventDefault();try{t&&t.silent||H(1,t)}catch(e){}};try{return I&&(window.addEventListener("unhandledrejection",(t=>e(t,t.reason))),window.addEventListener("error",(t=>e(t,t.error)))),this}catch(e){throw H(1,e),e}}withAsyncFlushOnExit(){try{return ge(Ce,{asyncFlushOnExit:!0}),this}catch(e){throw H(1,e),e}}withExitCodeLogging(){try{return ge(Ce,{logExitCode:!0}),this}catch(e){throw H(1,e),e}}withElementOnExit(){try{return ge(Ce,{appendElementOnExit:!0}),this}catch(e){throw H(1,e),e}}withAssertAfterExit(){try{return ge(Ce,{assertAfterExit:!0}),this}catch(e){throw H(1,e),e}}withWaitingForDebugger(e){try{return ge(Ce,{waitForDebugger:e}),this}catch(e){throw H(1,e),e}}withStartupMemoryCache(e){try{return ge(Ce,{startupMemoryCache:e}),this}catch(e){throw H(1,e),e}}withConfig(e){try{return ge(Ce,e),this}catch(e){throw H(1,e),e}}withConfigSrc(e){try{return e&&"string"==typeof e||B(!1,"must be file path or URL"),pe(_e,{configSrc:e}),this}catch(e){throw H(1,e),e}}withVirtualWorkingDirectory(e){try{return e&&"string"==typeof e||B(!1,"must be directory path"),this.virtualWorkingDirectory=e,this}catch(e){throw H(1,e),e}}withEnvironmentVariable(e,t){try{const o={};return o[e]=t,ge(Ce,{environmentVariables:o}),this}catch(e){throw H(1,e),e}}withEnvironmentVariables(e){try{return e&&"object"==typeof e||B(!1,"must be dictionary object"),ge(Ce,{environmentVariables:e}),this}catch(e){throw H(1,e),e}}withDiagnosticTracing(e){try{return"boolean"!=typeof e&&B(!1,"must be boolean"),ge(Ce,{diagnosticTracing:e}),this}catch(e){throw H(1,e),e}}withDebugging(e){try{return e&&"number"==typeof e||B(!1,"must be number"),ge(Ce,{debugLevel:e}),this}catch(e){throw H(1,e),e}}withApplicationArguments(...e){try{return e&&Array.isArray(e)||B(!1,"must be array of strings"),this.applicationArguments=e,this}catch(e){throw H(1,e),e}}withRuntimeOptions(e){try{return e&&Array.isArray(e)||B(!1,"must be array of strings"),ge(Ce,{runtimeOptions:e}),this}catch(e){throw H(1,e),e}}withMainAssembly(e){try{return ge(Ce,{mainAssemblyName:e}),this}catch(e){throw H(1,e),e}}withApplicationArgumentsFromQuery(){try{if(!globalThis.window)throw new Error("Missing window to the query parameters from");if(void 0===globalThis.URLSearchParams)throw new Error("URLSearchParams is supported");const e=new URLSearchParams(window.location.search).getAll("arg");return this.withApplicationArguments(...e)}catch(e){throw H(1,e),e}}withStartupOptions(e){return this.withApplicationEnvironment(e.environment).withApplicationCulture(e.applicationCulture).withResourceLoader(e.loadBootResource)}withApplicationEnvironment(e){try{return ge(Ce,{applicationEnvironment:e}),this}catch(e){throw H(1,e),e}}withApplicationCulture(e){try{return ge(Ce,{applicationCulture:e}),this}catch(e){throw H(1,e),e}}withResourceLoader(e){try{return P.loadBootResource=e,this}catch(e){throw H(1,e),e}}async create(){try{if(!this.instance){if(I&&_e.config.forwardConsoleLogsToWS&&void 0!==globalThis.WebSocket&&d("main",globalThis.console,globalThis.location.origin),j){const e=await import("process");if(e.versions.node.split(".")[0]<14)throw new Error(`NodeJS at '${e.execPath}' has too low version '${e.versions.node}'`)}_e||B(!1,"Null moduleConfig"),_e.config||B(!1,"Null moduleConfig.config"),await Ee(_e),this.instance=z.api}if(this.virtualWorkingDirectory){const e=this.instance.Module.FS,t=e.stat(this.virtualWorkingDirectory);t&&e.isDir(t.mode)||B(!1,`Could not find working directory ${this.virtualWorkingDirectory}`),e.chdir(this.virtualWorkingDirectory)}return this.instance}catch(e){throw H(1,e),e}}async run(){try{if(_e.config||B(!1,"Null moduleConfig.config"),this.instance||await this.create(),_e.config.mainAssemblyName||B(!1,"Null moduleConfig.config.mainAssemblyName"),!this.applicationArguments)if(j){const e=await import("process");this.applicationArguments=e.argv.slice(2)}else this.applicationArguments=[];return this.instance.runMainAndExit(_e.config.mainAssemblyName,this.applicationArguments)}catch(e){throw H(1,e),e}}},Oe=H,Te=Ee;k||"function"==typeof globalThis.URL||B(!1,"This browser/engine doesn't support URL API. Please use a modern version."),"function"!=typeof globalThis.BigInt64Array&&B(!1,"This browser/engine doesn't support BigInt64Array API. Please use a modern version.");export{Te as default,De as dotnet,Oe as exit};
//# sourceMappingURL=dotnet.js.map
