@namespace BlazorMdc.Demo

@page "/toast"

@inject IToastService toastService

<h1 class="mdc-typography--headline4">Toast samples</h1>

<p>See <code>ToastSample.razor</code> for sources.</p>

<p>
    Note the addition of <code>AddBMdcPlus.Toast()</code> in Startup.cs (Server) and Program.cs (WASM) as well as the component <code>BMdcPlus.Toasts</code> in MainLayout.razor.
</p>

<style>
    .my-class {
        font-style: italic;
    }
</style>

@if (overrideDefaults)
{
    <style>
        :root {
            --bmdc-toast-color-info: black !important;
            --bmdc-toast-color-success: black !important;
            --bmdc-toast-color-warning: black !important;
            --bmdc-toast-color-error: black !important;

            --bmdc-toast-filter-info: initial !important;
            --bmdc-toast-filter-success: initial !important;
            --bmdc-toast-filter-warning: initial !important;
            --bmdc-toast-filter-error: initial !important;

            --bmdc-toast-background-color-info: var(--bmdc-color-lightblue-200) !important;
            --bmdc-toast-background-color-success: var(--bmdc-color-green-200) !important;
            --bmdc-toast-background-color-warning: var(--bmdc-color-amber-200) !important;
            --bmdc-toast-background-color-error: var(--bmdc-color-red-200) !important;
            --bmdc-toast-border-radius: 16px !important;
        }
    </style>
}

<p><BMdc.Checkbox @bind-Value="@overrideDefaults" Label="Change colors and border radius from default" /></p>

<p><BMdcPlus.NumericIntField @bind-Value="@toastService.Configuration.MaxToastsShowing" Label="Max Toasts (0-10)" Min="0" Max="10" NumericFormat="N0" /></p>

<p>
    <BMdc.Button Style="background-color: var(--bmdc-toast-background-color-info);"
               @onclick="@InfoClick"
               Label="Info Toast"
               ButtonStyle="@EButtonStyle.ContainedRaised" />

    <BMdc.Button Style="background-color: var(--bmdc-toast-background-color-success);"
               @onclick="@(() => toastService.ShowToast(
                              level: EToastLevel.Success,
                              heading: "I'm a SUCCESS",
                              message: "Congratulations!" ))"
               Label="Success Toast"
               ButtonStyle="@EButtonStyle.ContainedRaised" />

    <BMdc.Button Style="background-color: var(--bmdc-toast-background-color-warning);"
               @onclick="@(() => toastService.ShowToast(
                              level: EToastLevel.Warning,
                              message: "I'm a WARNING" ))"
               Label="Warning Toast"
               ButtonStyle="@EButtonStyle.ContainedRaised" />

    <BMdc.Button Style="background-color: var(--bmdc-toast-background-color-error);"
               @onclick="@(() => toastService.ShowToast(
                              level: EToastLevel.Error,
                              message: "I'm an ERROR" ))"
               Label="Error Toast"
               ButtonStyle="@EButtonStyle.ContainedRaised" />
</p>

<p>Try different configuration options</p>
<p><BMdc.Select Label="Additional css class" @bind-Value="@cssClass" Items="cssClassItems" ItemValidation="@EItemValidation.DefaultToFirst"></BMdc.Select></p>
<p><BMdc.Select Label="Close method" @bind-Value="@closeMethod" Items="closeMethodItems"></BMdc.Select></p>
<p><BMdc.Select Label="Heading" @bind-Value="@heading" Items="headingItems" ItemValidation="@EItemValidation.DefaultToFirst"></BMdc.Select></p>
<p><BMdc.Select Label="Icon" @bind-Value="@icon" Items="iconItems" ItemValidation="@EItemValidation.DefaultToFirst"></BMdc.Select></p>
<p><BMdc.Select Label="Level" @bind-Value="@level" Items="levelItems"></BMdc.Select></p>
<p><BMdc.Select Label="Message" @bind-Value="@message" Items="messageItems" ItemValidation="@EItemValidation.DefaultToFirst"></BMdc.Select></p>
<p><BMdc.Select Label="Show icon" @bind-Value="@showIcon" Items="showIconItems" ItemValidation="@EItemValidation.DefaultToFirst"></BMdc.Select></p>
<p><BMdc.Select Label="Timeout" @bind-Value="@timeout" Items="timeoutItems" ItemValidation="@EItemValidation.DefaultToFirst"></BMdc.Select></p>
<p>
    <BMdc.Button @onclick="@customiseClick"
               Label="Toast with selected options"
               ButtonStyle="@EButtonStyle.ContainedRaised" />
</p>


@code{
    private bool overrideDefaults = false;

    string cssClass;
    ListElement<string>[] cssClassItems = new ListElement<string>[]
    {
        new ListElement<string> { SelectedValue = "", Label = "Default" },
        new ListElement<string> { SelectedValue = "my-class", Label = "Italic" },
    };


    EToastCloseMethod closeMethod;
    IEnumerable<ListElement<EToastCloseMethod>> closeMethodItems => from c in (EToastCloseMethod[])Enum.GetValues(typeof(EToastCloseMethod))
                                                                    select new ListElement<EToastCloseMethod>
                                                                    {
                                                                        SelectedValue = c,
                                                                        Label = c.ToString()
                                                                    };

#nullable enable annotations
    class MyIcon
    {
        public string Name;
        public IIconFoundry? Foundry;
    }
#nullable restore annotations

    MyIcon icon;
    ListElement<MyIcon>[] iconItems = new ListElement<MyIcon>[]
    {
        new ListElement<MyIcon> { SelectedValue = new MyIcon() { Name = "directions_run" }, Label = "directions_run" },
        new ListElement<MyIcon> { SelectedValue = new MyIcon() { Name = "thumb_up", Foundry = IconHelper.MIFoundry(theme: EIconMITheme.Filled) }, Label = "thumb_up (filled / default)" },
        new ListElement<MyIcon> { SelectedValue = new MyIcon() { Name = "thumb_up", Foundry = IconHelper.MIFoundry(theme: EIconMITheme.Outlined) }, Label = "thumb_up (outlined)" },
        new ListElement<MyIcon> { SelectedValue = new MyIcon() { Name = "thumb_up", Foundry = IconHelper.MIFoundry(theme: EIconMITheme.Round) }, Label = "thumb_up (rounded)" },
        new ListElement<MyIcon> { SelectedValue = new MyIcon() { Name = "thumb_up", Foundry = IconHelper.MIFoundry(theme: EIconMITheme.TwoTone) }, Label = "thumb_up (two-tone)" },
        new ListElement<MyIcon> { SelectedValue = new MyIcon() { Name = "thumb_up", Foundry = IconHelper.MIFoundry(theme: EIconMITheme.Sharp) }, Label = "thumb_up (sharp)" },
        new ListElement<MyIcon> { SelectedValue = new MyIcon() { Name = "fa-ambulance", Foundry = IconHelper.FAFoundry() }, Label = "fa-ambulance" },
        new ListElement<MyIcon> { SelectedValue = new MyIcon() { Name = "fa-ambulance", Foundry = IconHelper.FAFoundry(relativeSize: EIconFARelativeSize.ExtraSmall) }, Label = "fa-ambulance (x-small)" },
    };


    string heading;
    ListElement<string>[] headingItems = new ListElement<string>[]
    {
        new ListElement<string> { SelectedValue = "", Label = "Default" },
        new ListElement<string> { SelectedValue = "Run of the mill heading", Label = "Run of the mill heading" },
        new ListElement<string> { SelectedValue = "Heading truncated and truncated and truncated and truncated", Label = "Heading that will be truncated" }
    };


    EToastLevel level;
    IEnumerable<ListElement<EToastLevel>> levelItems => from c in (EToastLevel[])Enum.GetValues(typeof(EToastLevel))
                                                        select new ListElement<EToastLevel>
                                                        {
                                                            SelectedValue = c,
                                                            Label = c.ToString()
                                                        };

    string message;
    ListElement<string>[] messageItems = new ListElement<string>[]
    {
        new ListElement<string> { SelectedValue = "Run of the mill message", Label = "Run of the mill message" },
        new ListElement<string> { SelectedValue = "Text <strong>bold</strong> and <u>underlined</u>", Label = "Message with markup" },
        new ListElement<string> { SelectedValue = "Message truncated and truncated and truncated and truncated", Label = "Message that will be truncated" }
    };


    string showIcon;
    ListElement<string>[] showIconItems = new ListElement<string>[]
    {
        new ListElement<string> { SelectedValue = "", Label = "Default" },
        new ListElement<string> { SelectedValue = "true", Label = "true" },
        new ListElement<string> { SelectedValue = "false", Label = "false" }
    };


    string timeout;
    ListElement<string>[] timeoutItems = new ListElement<string>[]
    {
        new ListElement<string> { SelectedValue = "", Label = "Default" },
        new ListElement<string> { SelectedValue = "1000", Label = "1 second" },
        new ListElement<string> { SelectedValue = "10000", Label = "10 seconds" },
        new ListElement<string> { SelectedValue = "60000", Label = "60 seconds" }
    };


    protected void InfoClick()
    {
        toastService.ShowToast(
            level: EToastLevel.Info,
            message: "I'm an INFO");
    }


    protected void customiseClick()
    {
        string appliedCssClass = (cssClass.Length == 0) ? null : cssClass;

        string appliedHeading = (heading.Length == 0) ? null : heading;

        bool? appliedShowIcon = (showIcon.Length == 0) ? appliedShowIcon = null : appliedShowIcon = Convert.ToBoolean(showIcon);

        uint? appliedTimeout = (timeout.Length == 0) ? appliedTimeout = null : appliedTimeout = Convert.ToUInt32(timeout);

        toastService.ShowToast(
            cssClass: appliedCssClass,
            closeMethod: closeMethod,
            heading: appliedHeading,
            level: level,
            message: message,
            iconName: icon.Name,
            iconFoundry: icon.Foundry,
            showIcon: appliedShowIcon,
            timeout: appliedTimeout);
    }
}